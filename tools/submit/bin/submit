main() {
    # If first argument is provided, just print it between the submission markers
    if [ $# -gt 0 ]; then
        echo "<<SWE_AGENT_FILE_SUBMISSION>>"
        echo "<<TITLE>>"
        echo "$1"
        echo "<<TITLE>>"
        cat "$1"
        echo "<<SWE_AGENT_FILE_SUBMISSION>>"

        echo $1 > /root/submission_file_name.txt
        mv "$1" /root/submission_file.txt
        return 0
    fi

    cd $ROOT

    # Check if the patch file exists and is non-empty
    if [ -s "/root/test.patch" ]; then
        # Apply the patch in reverse
        git apply -R < "/root/test.patch"
    fi

    git add -A
    git diff --cached > /root/model.patch
    echo "<<SWE_AGENT_SUBMISSION>>"
    cat /root/model.patch
    echo "<<SWE_AGENT_SUBMISSION>>"
}

main "$@"
